<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.ibase4j.dao.sys.SysMenuExpandMapper">

	<resultMap id="BaseResultMap" type="org.ibase4j.model.generator.SysMenu">
		<id column="id" jdbcType="VARCHAR" property="id" />
		<result column="menu_name" jdbcType="VARCHAR" property="menuName" />
		<result column="menu_type" jdbcType="BIT" property="menuType" />
		<result column="parent_id" jdbcType="VARCHAR" property="parentId" />
		<result column="iconcls_" jdbcType="VARCHAR" property="iconcls" />
		<result column="request_" jdbcType="VARCHAR" property="request" />
		<result column="expand_" jdbcType="BIT" property="expand" />
		<result column="sort_no" jdbcType="INTEGER" property="sortNo" />
		<result column="is_show" jdbcType="BIT" property="isShow" />
		<result column="permission_" jdbcType="VARCHAR" property="permission" />
		<result column="remark_" jdbcType="VARCHAR" property="remark" />
		<result column="enable_" jdbcType="BIT" property="enable" />
		<result column="create_by" jdbcType="VARCHAR" property="createBy" />
		<result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
		<result column="update_by" jdbcType="VARCHAR" property="updateBy" />
		<result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
	</resultMap>

	<select id="query" parameterType="java.util.Map" resultType="java.lang.String">
		select id from sys_menu where 1=1
		<if test="parent_id != null">
			and parent_id = #{parent_id}
		</if>
		<if test="keyword != null">
			and (menu_name like '%'||#{keyword}||'%' or request_ like
			'%'||#{keyword}||'%')
		</if>
	</select>
	<select id="getPermissions" resultType="java.util.Map">
		select m.id || code_ as
		value, menu_name || code_text as text
		from sys_menu m
		join sys_dic_index
		di on di.key_='CRUD'
		join sys_dic d on d.index_id=di.id
		order by m.id
	</select>

	<select id="getAllListSorted" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select id, menu_name, menu_type, parent_id, iconcls_, request_,
		expand_, sort_no,
		is_show, permission_, remark_, enable_, create_by,
		create_time, update_by,
		update_time
		from sys_menu
		order by parent_id,sort_no
	</select>

</mapper>